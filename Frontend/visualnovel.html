<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visual Novel - Earthquake Survival</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Crimson Text', serif;
            touch-action: manipulation; /* Prevents double-tap zoom on mobile */
        }
        .text-shadow {
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
        }
        #background-image {
            transition: opacity 0.7s ease-in-out;
        }
        .choice-button {
            transition: background-color 0.2s, transform 0.2s;
        }
        .choice-button:hover {
            transform: translateY(-2px);
        }
        .rumble-effect {
            animation: rumble 0.5s infinite;
        }
        @keyframes rumble {
            0%, 100% { transform: translate(0, 0) rotate(0); }
            25% { transform: translate(2px, 1px) rotate(-0.5deg); }
            50% { transform: translate(-1px, -2px) rotate(0.5deg); }
            75% { transform: translate(1px, -1px) rotate(-0.2deg); }
        }

        /* Responsive Styles */
        @media (max-width: 767px) {
            body {
                padding: 0.5rem;
            }
            #game-container {
                aspect-ratio: 9 / 16;
                width: 100%;
                max-width: 400px; /* Limit width on mobile for better appearance */
                margin: auto;
            }
            #dialogue-text {
                font-size: 1rem; /* approx text-base */
                min-height: 7rem;
            }
            #ui-container {
                padding: 1rem;
            }
            #choices-container {
                flex-direction: column;
            }
            .choice-button {
                font-size: 1rem;
                padding: 0.75rem 1rem;
            }
            #start-screen h1 {
                font-size: 2.5rem;
            }
            #start-screen p {
                font-size: 1rem;
            }
        }
        @media (min-width: 768px) {
            body {
                padding: 1rem;
            }
            #game-container {
                aspect-ratio: 16 / 9;
                max-width: 1280px;
                width: 100%;
            }
             #dialogue-text {
                min-height: 5rem;
            }
            #choices-container {
                flex-direction: row;
            }
        }
    </style>
</head>
<body class="bg-gray-900 flex items-center justify-center h-screen overflow-hidden">

    <div id="game-container" class="relative bg-black rounded-lg overflow-hidden shadow-2xl border-4 border-gray-700">
        <!-- Background Image -->
        <!-- The initial image corresponds to "1. The Calm Before" -->
        <img id="background-image" src="/public/image_1_calm_before.png" alt="Game Background" class="absolute top-0 left-0 w-full h-full object-cover">

        <!-- Character Sprite (Kept for potential future use, but hidden) -->
        <div id="character-container" class="absolute bottom-0 left-1/2 -translate-x-1/2 h-full w-3/5 flex items-end justify-center">
            <img id="character-sprite" src="" alt="Character" class="h-full object-contain drop-shadow-2xl" style="opacity: 0;">
        </div>

        <!-- UI Container -->
        <div id="ui-container" class="absolute bottom-0 left-0 w-full p-4 sm:p-6 text-shadow">
            <div class="bg-black bg-opacity-40 rounded-xl p-4 sm:p-6 text-white backdrop-blur-sm border border-white/20">
                <p id="dialogue-text" class="text-base sm:text-lg md:text-xl"></p>
            </div>

            <!-- Choices -->
            <div id="choices-container" class="flex justify-end gap-4 mt-4">
                <!-- Choice buttons will be injected here by JavaScript -->
            </div>
        </div>

        <!-- Start/Loading Screen -->
        <div id="start-screen" class="absolute inset-0 bg-black bg-opacity-80 flex flex-col items-center justify-center z-50 text-center p-4">
            <h1 class="text-white text-4xl sm:text-5xl font-bold mb-4">The Tremor</h1>
            <p class="text-gray-300 mb-6 sm:mb-8 max-w-2xl">It's just after 4 PM at your school in Guwahati. You're finishing up some homework when the room starts to shake. It's an earthquake!</p>
            <button id="start-button" class="choice-button bg-violet-700 text-white font-bold py-3 px-6 text-lg sm:text-xl sm:px-8 rounded-lg hover:bg-violet-600 shadow-lg">
                Begin
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM ELEMENTS ---
            const gameContainer = document.getElementById('game-container');
            const backgroundImage = document.getElementById('background-image');
            const dialogueText = document.getElementById('dialogue-text');
            const choicesContainer = document.getElementById('choices-container');
            const startScreen = document.getElementById('start-screen');
            const startButton = document.getElementById('start-button');

            // --- GAME STORY DATA ---
            // Replace the placeholder image names with your actual generated image files.
            // These names correspond to the AI prompts provided.
            const story = {
                'start': {
                    background: '/public/image_2_initial_jolt.png',
                    soundEffect: 'rumble',
                    text: "The shaking gets stronger! The ground is moving, and things are falling from the shelves. What should you do right now?",
                    choices: [
                        { text: "Get under a desk", next: 'hide_under_desk' },
                        { text: "Run for the door", next: 'run_outside' },
                        { text: "Stay still", next: 'freeze_in_panic' }
                    ]
                },
                'hide_under_desk': {
                    background: '/public/image_3_under_desk.png',
                    soundEffect: 'rumble',
                    text: "You quickly get under a strong desk and hold on tight. Good choice! A big fan falls from the ceiling and lands right where you were standing. The desk protected you.",
                    next: 'shaking_stops'
                },
                'run_outside': {
                    background: '/public/image_4_running_for_door.png',
                    text: "You panic and run for the door. But running during an earthquake is dangerous. A heavy light falls and blocks the way. This is not a safe choice. (Game Over)",
                    choices: [
                        { text: "Try Again", next: 'start' }
                    ]
                },
                'freeze_in_panic': {
                    background: '/public/image_2_initial_jolt.png',
                    soundEffect: 'rumble',
                    text: "You're too scared to move. A window breaks nearby, and glass flies through the air. You're okay, but that was very close. Standing in the open is risky.",
                    next: 'shaking_stops'
                },
                'shaking_stops': {
                    background: '/public/image_5_aftermath.png',
                    text: "The shaking stops. The classroom is a mess. Everything is quiet now. You need to get outside to a safe, open area. What's the best way out?",
                    choices: [
                        { text: "Check the hallway", next: 'cautious_evacuation' },
                        { text: "Wait for help", next: 'stay_put' },
                        { text: "Shout for help", next: 'shout_for_help' }
                    ]
                },
                'cautious_evacuation': {
                    background: '/public/image_6_cautious_evacuation.png',
                    text: "You carefully open the door. The hallway is damaged, but you can walk through it. You see the green 'EXIT' sign far away.",
                    choices: [
                        { text: "Take the stairs", next: 'take_stairs' },
                        { text: "Use the elevator", next: 'use_elevator' }
                    ]
                },
                'stay_put': {
                    background: '/public/image_7_waiting.png',
                    soundEffect: 'rumble',
                    text: "You decide to stay and wait for help. But then, a strong aftershock begins! The damaged ceiling collapses. Waiting inside was not safe. (Game Over)",
                    choices: [
                        { text: "Try Again", next: 'start' }
                    ]
                },
                'shout_for_help': {
                    background: '/public/image_5_aftermath.png',
                    text: "You shout for help, but no one answers. In a disaster, you often have to rely on yourself to get to safety first. It's time to find a way out.",
                    next: 'cautious_evacuation'
                },
                'use_elevator': {
                    background: '/public/image_8_elevator.png',
                    text: "You run to the elevator. This is a big mistake. After an earthquake, the power can fail. The doors close, and the elevator stops. You are trapped in the dark. (Game Over)",
                    choices: [
                        { text: "Try Again", next: 'start' }
                    ]
                },
                'take_stairs': {
                    background: '/public/image_9_stairs.png',
                    text: "You choose the stairs. This is the correct way to exit a building during an emergency. You walk down carefully, holding the railing.",
                    next: 'outside_safe'
                },
                'outside_safe': {
                    background: '/public/image_10_outside_safe.png',
                    text: "You get outside to the school's open field, away from the building. Other students and teachers are already here. You are safe because you made smart choices! (You Win!)",
                    choices: [
                        { text: "Play Again", next: 'start' }
                    ]
                }
            };

            let currentSceneId = 'start';
            let isTyping = false;

            function typeWriter(text, i = 0) {
                isTyping = true;
                if (i < text.length) {
                    dialogueText.innerHTML = text.substring(0, i + 1) + '<span class="animate-ping">|</span>';
                    setTimeout(() => typeWriter(text, i + 1), 30);
                } else {
                    dialogueText.innerHTML = text;
                    isTyping = false;
                    displayChoices(story[currentSceneId]);
                }
            }
            
            function displayChoices(scene) {
                choicesContainer.innerHTML = '';
                if (scene.choices) {
                    scene.choices.forEach(choice => {
                        const button = document.createElement('button');
                        button.innerText = choice.text;
                        button.className = 'choice-button bg-black bg-opacity-70 text-white font-bold py-2 px-6 rounded-lg hover:bg-violet-700 text-lg shadow-md w-full';
                        button.onclick = () => showScene(choice.next);
                        choicesContainer.appendChild(button);
                    });
                } else if (scene.next) {
                    const button = document.createElement('button');
                    button.innerText = 'Next →';
                    button.className = 'choice-button bg-black bg-opacity-70 text-white font-bold py-2 px-6 rounded-lg hover:bg-violet-700 text-lg shadow-md w-full';
                    button.onclick = () => showScene(scene.next);
                    choicesContainer.appendChild(button);
                }
            }

            function showScene(sceneId) {
                if (!story[sceneId] || isTyping) return;
                
                currentSceneId = sceneId;
                const scene = story[sceneId];
                
                if (scene.soundEffect === 'rumble') {
                    gameContainer.classList.add('rumble-effect');
                } else {
                    gameContainer.classList.remove('rumble-effect');
                }

                const newSrc = scene.background;
                if (!backgroundImage.src.endsWith(newSrc)) {
                    backgroundImage.style.opacity = 0;
                    setTimeout(() => {
                        backgroundImage.src = newSrc;
                        backgroundImage.style.opacity = 1;
                    }, 700);
                }
                
                choicesContainer.innerHTML = '';
                typeWriter(scene.text);
            }
            
            function startGame() {
                startScreen.style.transition = 'opacity 0.5s';
                startScreen.style.opacity = 0;
                setTimeout(() => {
                    startScreen.style.display = 'none';
                    showScene('start');
                }, 500);
            }
            
            startButton.addEventListener('click', startGame);
        });
    </script>
</body>
</html>